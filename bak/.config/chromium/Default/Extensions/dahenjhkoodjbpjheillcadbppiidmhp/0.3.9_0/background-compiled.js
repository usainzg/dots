(function(){/*

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/
var aa=this||self;var ba;ba=typeof Symbol==="function"&&typeof Symbol()==="symbol"?Symbol.for?Symbol.for("jas"):Symbol("jas"):void 0;const ca=typeof Symbol==="function"&&typeof Symbol()==="symbol"?ba:"ib",da=Object.getOwnPropertyDescriptor(Array.prototype,"Ma");Object.defineProperties(Array.prototype,{Ma:{get(){const a=ea(this);return da?da.get.call(this)+"|"+a:a},configurable:!0,enumerable:!1}});
function ea(a){function b(e,f){e&c&&d.push(f)}const c=a[ca]|0,d=[];b(1,"IS_REPEATED_FIELD");b(2,"IS_IMMUTABLE_ARRAY");b(4,"IS_API_FORMATTED");b(512,"STRING_FORMATTED");b(1024,"GBIGINT_FORMATTED");b(1024,"BINARY");b(8,"ONLY_MUTABLE_VALUES");b(16,"UNFROZEN_SHARED");b(32,"MUTABLE_REFERENCES_ARE_OWNED");b(64,"CONSTRUCTED");b(128,"HAS_MESSAGE_ID");b(256,"FROZEN_ARRAY");b(2048,"HAS_WRAPPER");b(4096,"MUTABLE_SUBSTRUCTURES");b(8192,"KNOWN_MAP_ARRAY");c&64&&(a=c>>14&1023||536870912,a!==536870912&&d.push(`pivot: ${a}`));
return d.join(",")};typeof Proxy!=="undefined"&&new Proxy({},{getPrototypeOf:w,setPrototypeOf:w,isExtensible:w,preventExtensions:w,getOwnPropertyDescriptor:w,defineProperty:w,has:w,get:w,set:w,deleteProperty:w,apply:w,construct:w});function w(){throw Error("this array or object is owned by JSPB and should not be reused, did you mean to copy it with copyJspbArray? See go/jspb-api-gotchas#construct_from_array");};function fa(){};(function(){const a=aa.jspbGetTypeName;aa.jspbGetTypeName=a?b=>a(b)||void 0:fa})();class x{get(a,b){chrome.storage.local.get(a,c=>{b(chrome.runtime.lastError?null:c)})}set(a){chrome.storage.local.set(a,function(){})}remove(a){chrome.storage.local.remove(a)}};const ha=["http:","https:","ftp:","file:","mailto:"];function ia(){let a,b;return{promise:new Promise((c,d)=>{a=c;b=d}),resolve:a,reject:b}}function ja(a){return ha.some(b=>a.toLowerCase().startsWith(b))};function ka(a,b){if(a.length!==b.length)return!1;for(let f=0;f<a.length;f++){var c=a[f],d=b[f],e;if(!(e=c.pageIndex!==d.pageIndex)){a:if(e=c.bounds,d=d.bounds,e.length!==d.length)e=!1;else{for(c=0;c<e.length;c++){const g=e[c],h=d[c];if(Math.abs(g.left-h.left)>1||Math.abs(g.top-h.top)>1||Math.abs(g.width-h.width)>1||Math.abs(g.height-h.height)>1||Math.abs(g.angle-h.angle)>.01){e=!1;break a}}e=!0}e=!e}if(e)return!1}return!0};var la=Math.ceil(Number.MAX_SAFE_INTEGER/2);function ma(a){if(a===void 0)return new Map;if(!Array.isArray(a))return null;const b=new Map;for(const e of a){if(!Array.isArray(e)||e.length!==2)return null;a=e[0];var c=e[1];if(c&&typeof c==="object"){var d=c.clientId;c=y(c.update);d=B(d)&&c?{clientId:d,update:c}:null}else d=null;if(!B(a)||!d)return null;b.set(a,d)}return b}function C(a,b=0){return{type:a,P:b}}function na(a){return a.map(b=>({id:b.id,bounds:D(b.bounds)}))}
function oa(a){if(a===void 0)return[];if(!Array.isArray(a))return null;const b=[];for(const c of a){if(!c||typeof c!=="object")return null;a=c.id;const d=E(c.bounds);if(!B(a)||!d)return null;b.push({id:a,bounds:d})}return b}function pa(a){return Array.isArray(a)&&a.length===2&&B(a[0])&&Number.isFinite(a[1])}
var qa=function(a,b){for(let c=0;c<a.h.length;c++)if(a.h[c].id===b){a.h.splice(c,1);break}a.g.delete(b);a.i.delete(b)},ra=function(a,b,c){a.g.has(b)&&qa(a,b);const d=c.update.o;d&&d.length!==0&&(a.h.push({bounds:d,id:b}),a.g.set(b,c),a.i.set(b,a.j))},sa=class{constructor(a,b,c={Ea:new Map,pa:[]}){this.j=a;this.i=b;this.g=c.Ea;this.h=c.pa}K(a,b){var c=b.o;if(!c||c.length===0)return!1;const d=b.l||a;a:if(this.g.has(d))c=d;else{for(var e of this.h)if(ka(e.bounds,c)){c=e.id;break a}c=0}if(c=c?{key:c,
value:this.g.get(c)}:null){e=c.value.update;const f=b.G||0;if((e.G||0)>=f)return!1;if(b.l&&e.l!==b.l)return qa(this,c.key),ra(this,d,{clientId:a,update:b}),!0;if(e.m===b.m&&(e.comment||"")===(b.comment||""))return e.G=f,!1;c.value.update=b;return!0}ra(this,d,{clientId:a,update:b});return!0}F(){const a=[];for(const b of this.g.values()){const c=b.update;!c.l&&!c.m&&!c.text||a.push(b.update)}return a}};
function ta(a,b){if(a===void 0)return new Map;if(!Array.isArray(a))return null;const c=new Map;for(const f of a){if(!Array.isArray(f)||f.length!==2)return null;a=f[0];a:{var d=f[1];var e=b;if(!d||typeof d!=="object"){e=null;break a}const g=d.pageIndex,h=ma(d.updateEntries);d=oa(d.boundsIdPairList);e=Number.isFinite(g)&&h&&d?new sa(g,e,{Ea:h,pa:d}):null}if(!Number.isFinite(a)||!e)return null;c.set(a,e)}return c}
var ua=class{constructor(a={wa:new Map,xa:new Map}){this.g=a.wa;this.h=a.xa}K(a,b){var c=b.o;c&&c.length!==0?(c=c[0].pageIndex,this.g.has(c)||this.g.set(c,new sa(c,this.h)),a=this.g.get(c).K(a,b)):a=!1;return a}F(){const a=[];for(const b of this.g.values())a.push(...b.F());return a}clear(){this.g.clear()}};function F(a){return typeof a==="string"&&ja(a)}function G(a){return typeof a==="string"&&a.length>0}function H(a){return Array.isArray(a)&&a.every(G)}
function va(a){if(!Array.isArray(a))return!1;const b=new Set;let c=0;for(const d of a){if(!H(d))return!1;c+=d.length;for(const e of d)b.add(e)}return b.size===c}function I(a){return typeof a==="number"&&Number.isFinite(a)&&a>=0}function B(a){return typeof a==="number"&&Number.isFinite(a)&&a>0}function wa(a){return typeof a==="string"&&a.length>0&&a.length<=3E3}
function xa(a){if(!a||typeof a!=="object")return null;const b=a.pageIndex;if(!Number.isFinite(b))return null;var c=a.bounds;if(!Array.isArray(c)||c.length===0)return null;a=[];for(const d of c){c=d.left;const e=d.top,f=d.width,g=d.height,h=d.angle||0;if(!(Number.isFinite(c)&&Number.isFinite(e)&&B(f)&&B(g)&&Number.isFinite(h)))return null;a.push({left:c,top:e,width:f,height:g,angle:h})}return{pageIndex:b,bounds:a}}
function E(a){if(!Array.isArray(a)||a.length===0)return null;const b=[];for(const c of a){a=xa(c);if(!a)return null;b.push(a)}return b}
function y(a){if(!a||typeof a!=="object")return null;const b=a.serverId,c=a.colorId,d=a.text,e=a.comment;var f=a.pageHighlightBoundsList;const g=a.serverTs;a=a.clientTs;if(!I(b)||!I(a)||!I(g))return null;f=f===void 0?void 0:E(f);return typeof c==="number"&&c>0&&c<=5&&wa(d)&&(e===void 0||typeof e==="string"&&e.length<=2E3)&&f?{l:b,m:c,text:d,comment:e,o:f,D:g,G:a}:b>0&&c===void 0&&d===void 0&&e===void 0&&(f===void 0||f)?{l:b,o:f,D:g,G:a}:null}
function D(a){const b=[];for(const c of a)b.push({pageIndex:c.pageIndex,bounds:c.bounds.map(d=>({left:d.left,top:d.top,width:d.width,height:d.height,angle:d.angle}))});return b}function J(a){return{serverId:a.l,colorId:a.m,text:a.text,comment:a.comment,pageHighlightBoundsList:a.o?D(a.o):void 0,clientTs:a.G,serverTs:a.D}}
var za=function(a){const b=new ya;if(!a||!Array.isArray(a))return b;const c=[];for(const d of a){if(!d||typeof d!=="object")return b;a=d.u;if(!a||typeof a!=="string")return b;c.push({userId:a,Ia:Number(d.fc)||0,Za:Number(d.qe)||0,Ja:Number(d.fp)||0,Ka:Number(d.ge)||0})}b.g=c;return b},Aa=function(a,b){a.g=a.g.filter(c=>c.userId!==b)},ya=class{constructor(){this.g=[]}};function K(a){return!!a&&typeof a==="string"}function Ba(a){return typeof a==="number"&&Number.isFinite(a)&&a>=0}function Ca(a){return{oldPdfIds:a.Ua,newPdfIds:a.Qa,firstPdfIds:a.aa,highlightUpdates:a.ba.map(J)}}function Da(a,b,c,d,e,f,g){return{type:"syncHighlightsResponse",authuser:a,userId:b,xsrf:c,isFullSync:d,syncedToServerTs:e,errorInfo:{type:f.type,citationId:f.P},pdfHighlightUpdates:g.map(Ca)}};function L(a,b){if(a===void 0)return[];if(!Array.isArray(a))return null;const c=[];for(const d of a){a=b(d);if(a===null)return null;c.push(a)}return c}function Ea(a){a=L(a,b=>b&&typeof b==="object"?b.pdf_ids:null);return va(a)?a:null}function Fa(a){if(!a||typeof a!=="object")return null;const b=a.citation_id;return B(b)?(a=Ea(a.client_pdf_id_lists))?{P:Number(b),Ha:a}:null:null}
function Ga(a){if(!Array.isArray(a)||a.length===0)return null;const b=[],c=new Map;for(var d of a){if(!d||typeof d!=="object")return null;a=d.page_index;const g=d.left;var e=d.right;const h=d.top;var f=d.bottom;const k=d.angle||0;if(!(Number.isFinite(a)&&Number.isFinite(g)&&Number.isFinite(e)&&Number.isFinite(h)&&Number.isFinite(f)&&Number.isFinite(k)))return null;e-=g;f-=h;if(e<=0||f<=0)return null;c.has(a)||c.set(a,[]);c.get(a).push({left:g,top:h,width:e,height:f,angle:k})}d=Array.from(c.keys());
d.sort();for(const g of d)b.push({pageIndex:g,bounds:c.get(g)});return b}function Ha(a){if(!a||typeof a!=="object")return null;const b=a.bounds===void 0?void 0:Ga(a.bounds);return(a=y({serverId:a.id,text:a.text,colorId:a.color_id,comment:a.comment,pageHighlightBoundsList:b,serverTs:a.server_ts,clientTs:0}))&&B(a.l)?a:null}
function Ia(a){if(!a||typeof a!=="object")return null;const b=a.primary_pdf_id,c=a.first_pdf_ids||[];var d=a.remote_urls;d!==void 0?d&&typeof d==="object"?(d=d.urls||[],d=Array.isArray(d)&&d.every(F)?d:null):d=null:d=void 0;a=L(a.highlights||[],Ha);return G(b)&&H(c)&&d!==null&&a?{ga:b,aa:c,bb:d,gb:a}:null}function Ja(a){return{serverId:a.l,colorId:a.m,text:a.text,comment:a.comment,pageHighlightBoundsList:D(a.o),serverTs:a.D}}
function Ka(a){if(!a||typeof a!=="object")return null;const b=a.serverId,c=a.colorId,d=a.text,e=a.comment,f=E(a.pageHighlightBoundsList);a=a.serverTs;return B(b)&&typeof c==="number"&&c>0&&c<=5&&wa(d)&&typeof e==="string"&&e.length<=2E3&&f!==null&&f.length!==0&&B(a)?{l:b,m:c,text:d,comment:e,o:f,D:a}:null};function La(a){return{l:a.l,m:a.m,text:a.text,comment:a.comment,o:a.o,D:a.D,G:0}}function Ma(a,b,c,d){return`${"https://scholar.google.com"}/citations?update_op=sync_highlights&gsr_hv=${4}&user=${encodeURIComponent(a)}&xsrf=${encodeURIComponent(c)}&hl=${encodeURIComponent(d)}${b>0?`&authuser=${b}`:""}&oi=gsr&json=`}
function Na(a,b){b={last_synced_timestamp_usec:b};a.length>0&&(b.highlights_to_save=a);a=new URLSearchParams;a.append("gsr_sync_hl",JSON.stringify(b));return{credentials:"include",method:"POST",redirect:"error",signal:AbortSignal.timeout(29E3),body:a.toString()}}
var M=class{constructor(a={za:new ua,Ba:"",title:"",va:la}){this.g=a.za;this.ia=a.Ba;this.S=a.title;this.h=a.va}updateUrl(a){a.startsWith("file://")||(this.ia=a)}getTitle(){return this.S}K(a){const b=this.h++;this.g.K(b,a)}F(){return this.g.F()}},Oa=function(a,b,c){const d=a.J.get(c);if(d){var e=a.C.get(d);e.delete(c);e.size===0&&a.C.delete(d);a.J.delete(c)}a.J.set(c,b);a.C.has(b)||a.C.set(b,new Set);a.C.get(b).add(c)},N=class{constructor(a={Aa:new Map,ya:new Map}){this.C=a.Aa;this.J=a.ya}clear(){this.C.clear();
this.J.clear()}};
function Pa(a){if(a===void 0)return new Map;if(!Array.isArray(a))return null;const b=new Map;for(const f of a){if(!Array.isArray(f)||f.length!==2)return null;a=f[0];a:{var c=f[1];if(c===void 0){c=new M;break a}if(!c||typeof c!=="object"){c=null;break a}var d;if((d=c.pendingUpdates)&&typeof d==="object"){var e=d.pendingIdToPageIndexEntries;d=(e=e===void 0?new Map:Array.isArray(e)&&e.every(pa)?new Map(e):null)?(d=ta(d.pagePendingUpdatesEntries,e))?new ua({wa:d,xa:e}):null:null}else d=null;e=c.remoteUrl;
const g=c.title;c=c.nextClientId;c=d&&(e===""||F(e))&&typeof g==="string"&&B(c)?new M({za:d,Ba:e,title:g,va:c}):null}if(!G(a)||!c)return null;b.set(a,c)}return b};var Qa=class extends Error{constructor(a){super(a)}},Ra=class extends Error{constructor(a){super(a)}},Q=function(a,b,c){return new Promise((d,e)=>{const f=a.g.put(c,b);f.onsuccess=()=>{d()};f.onerror=()=>{e("Failed to set "+b+" : "+JSON.stringify(c))}})},Sa=class{constructor(a){this.g=a}get(a){return new Promise((b,c)=>{const d=this.g.get(a);d.onsuccess=e=>{b(e.target.result)};d.onerror=()=>{c("Error getting key "+a)}})}getAll(a){return new Promise((b,c)=>{const d=this.g.getAll(a);d.onsuccess=e=>
{b(e.target.result)};d.onerror=()=>{c("Failed to get all in range "+JSON.stringify(a))}})}index(a,b){return new Promise((c,d)=>{const e=new Map,f=this.g.index(a).openCursor(b);f.onsuccess=g=>{(g=g.target.result)?(e.set(g.primaryKey,g.value),g.continue()):c(e)};f.onerror=()=>{d("Failed to get cursor for index "+a)}})}delete(a){return new Promise((b,c)=>{const d=this.g.delete(a);d.onsuccess=()=>{b()};d.onerror=()=>{c("Failed to delete "+a)}})}clear(){return new Promise((a,b)=>{const c=this.g.clear();
c.onsuccess=()=>{a()};c.onerror=()=>{b("Failed to clear "+this.g.name)}})}},Ta=class{constructor(a){this.g=a;this.complete=new Promise((b,c)=>{this.g.oncomplete=()=>{b()};this.g.onerror=()=>{c("Failed to complete transaction "+this.g.mode+" for object stores "+Array.from(this.g.objectStoreNames).join(", "))};this.g.onabort=d=>{d.target.error.name==="QuotaExceededError"&&c(new Ra("Transaction aborted due to quota exceeded for object stores "+Array.from(this.g.objectStoreNames).join(", ")));c("Transaction aborted for object stores "+
Array.from(this.g.objectStoreNames).join(", "))}})}objectStore(a){return new Sa(this.g.objectStore(a))}};const Ua=Symbol("private constructor");
var Wa=async function(a,b){const c=await new Promise((d,e)=>{const f=indexedDB.open(a,2);f.onerror=()=>{e(new Qa("Failed to open database "+a))};f.onsuccess=g=>{d(g.target.result)};f.onupgradeneeded=g=>{b(g)}});return new Va(c)},Xa=async function(a){a.h.close();return new Promise((b,c)=>{const d=indexedDB.deleteDatabase(a.g);d.onsuccess=()=>{b()};d.onerror=()=>{c("Error deleting database "+a.g)}})},Va=class{constructor(a){if(Ua!==Ua)throw Error("IndexedDb should only be created by the static open() method.");
this.g=a.name;this.h=a}transaction(a,b){return new Ta(this.h.transaction(a,b))}};const R="SyncedToServerTs LastSuccessfulSyncClientTs CitationIdToPdfIds PrimaryPdfIdToRemoteUrls Highlight PendingUpdates".split(" "),Ya=[{name:"SyncedToServerTs"},{name:"CitationIdToPdfIds",ra:[{name:"PdfIds",keyPath:"pdfIds",options:{multiEntry:!0}}]},{name:"PrimaryPdfIdToRemoteUrls",ra:[{name:"RemoteUrl",keyPath:"",options:{multiEntry:!0}}]},{name:"Highlight"},{name:"PendingUpdates"}],Za=[{name:"LastSuccessfulSyncClientTs"}];var S=class extends Error{constructor(a){super(a)}};
function $a(a,b){return a===b}function ab(a,b){if(a.length!==b.length)return!1;for(let e=0;e<a.length;e++){a:{var c=a[e];var d=b[e];if(c.length!==d.length)c=!1;else{for(let f=0;f<c.length;f++)if(c[f]!==d[f]){c=!1;break a}c=!0}}if(!c)return!1}return!0}function bb(a,b){return a.l===b.l&&a.m===b.m&&a.text===b.text&&a.comment===b.comment&&ka(a.o,b.o)}function cb(a){const b=[];for(const c of a.values())for(const d of c)d.length!==0&&b.push(d[0]);return b}
function db(a){const b=[];for(const c of a)b.push(...c);return{pdfIds:b,pdfIdsList:a}}function eb(a){if(!a||typeof a!=="object")return null;var b=a.pdfIds;a=a.pdfIdsList;if(!H(b)||!va(a))return null;b=new Set(b);for(const c of a)for(const d of c)if(!b.delete(d))return null;return b.size!==0?null:a}function fb(a){for(const b of a.values())if(b.F().length>0)return!0;return!1}function gb(a){const b=new Map;for(const c of a.values())for(const d of c)d.length!==0&&b.set(d[0],d);return b}const hb=Symbol("private constructor");
var mb=async function(a,b=!1){a=await Wa("ScholarReader"+a,f=>{const g=f.target.result,h=k=>{for(const {name:l,ra:m}of k)if(k=g.createObjectStore(l),m)for(const {name:q,keyPath:n,options:p}of m)k.createIndex(q,n,p)};f=f.oldVersion;f<1&&h(Ya);f<2&&h(Za)});const c=new ib(a);a=c.i.transaction(R,"readwrite");b&&await jb(a);b=T(a).then(f=>{c.g=f});const d=kb(a).then(f=>{c.j=f}),e=lb(a);await Promise.all([b,d,e,a.complete]);c.h=!1;return c},jb=async function(a){const b=R.map(c=>a.objectStore(c).clear());
await Promise.all(b)},T=async function(a){a=await a.objectStore("SyncedToServerTs").get("TimestampUsec");if(a===void 0)return 0;if(!I(a))throw new S("Invalid synced to server ts: "+JSON.stringify(a));return Number(a)},kb=async function(a){a=await a.objectStore("LastSuccessfulSyncClientTs").get("TimestampMs");if(a===void 0)return 0;if(!I(a))throw new S("Invalid last successful sync client ts: "+JSON.stringify(a));return Number(a)},lb=async function(a){await a.objectStore("PendingUpdates").clear()},
nb=function(a){a.g=0;a.h=!1;a.j=0},ob=async function(a){const b=a.i.transaction(R,"readwrite");await lb(b);a.h=!1},rb=async function(a,b,c){const d=new Set;for(var {P:e}of a)d.add(e);e=[];for(const {ga:g}of b)e.push(pb(g,c).then(h=>{h&&d.add(h)}));await Promise.all(e);const f=new Map;b=[];for(const g of d)b.push(qb(g,c).then(h=>{h.length>0&&f.set(g,h)}));await Promise.all(b);c=new Map(f);for(const {P:g,Ha:h}of a)h.length>0?c.set(g,h):c.delete(g);return{Oa:c,Sa:f}},tb=async function(a,b,c,d){const e=
new Map,f=new Map;a=new Set(cb(a));const g=new Set(cb(b));b=new Set;for(var h of g)a.has(h)||b.add(h);for(var k of c)c=k.ga,h=k.bb,h!==void 0&&(b.add(c),h.length>0&&e.set(c,h));k=[];for(const l of b)k.push(sb(l,d).then(m=>{f.set(l,m)}));await Promise.all(k);return{Ra:e,Va:f}},vb=async function(a,b,c,d){const e=new Map,f=new Map,g=[],h=[];for(const k of a){const l=k.ga,m=k.aa,q=k.gb,n=new Map;a=Promise.all(q.map(({l:p})=>ub(l,p,d).then(r=>{r&&n.set(r.l,r)})));h.push(a.then(()=>{if(q.length!==0){var p=
new Map(n),r=[];for(var t of q)t.m||t.text?p.set(t.l,{l:t.l,m:t.m,text:t.text,comment:t.comment||"",o:t.o,D:t.D}):(p.delete(t.l),r.push(t));for(var u of p.keys())f.set(`${l}:${u}`,p.get(u));for(const v of n.keys())e.set(`${l}:${v}`,n.get(v));t=c.get(l)||[];u=b.get(l)||[];if(t.length===0&&n.size>0||u.length===0&&p.size>0)throw new S("Missing new pdf ids for primary pdf id: "+l);if(t.length!==0||u.length!==0){for(const v of p.values())r.push(La(v));g.push({Ua:t,Qa:u,aa:m,ba:r})}}}))}await Promise.all(h);
return{Pa:f,Ta:e,I:g}},wb=async function(a){const b=a.ca,c=a.ea,d=a.V,e=a.Y;a=a.transaction.objectStore(a.da);const f=[];for(const [g,h]of b.entries()){const k=c.get(g);k!==void 0&&d(h,k)||f.push(Q(a,""+g,e(h)))}for(const [g]of c.entries())b.has(g)||f.push(a.delete(""+g));return Promise.all(f)},xb=async function(a,b,c){var d=Date.now();if(c===3)return d=a.i.transaction(R,"readwrite"),await Promise.all([jb(d),d.complete]),nb(a),{I:[],R:!1,v:0};if(!b||c!==0)return a.h&&await ob(a),{I:[],R:!1,v:a.g};
c=b.fb;var e=b.Ga,f=b.La,g=d-a.j>432E5;b=b.eb===0;if(!b){var h=e.length>0||f.length>0;if(a.g>c||a.g===c&&h)throw new S("Cached timestamp "+a.g+" is ahead of the new timestamp: "+c+", or there are unsaved updates.");if(a.g===c&&!g&&!a.h)return{I:[],R:!1,v:a.g}}g=a.i.transaction(R,"readwrite");b&&await jb(g);const {Oa:k,Sa:l}=await rb(e,f,g);e=gb(k);h=gb(l);const [{Ra:m,Va:q},{Pa:n,Ta:p,I:r}]=await Promise.all([tb(k,l,f,g),vb(f,e,h,g)]);f=[];f.push(Q(g.objectStore("SyncedToServerTs"),"TimestampUsec",
c));f.push(Q(g.objectStore("LastSuccessfulSyncClientTs"),"TimestampMs",d));f.push(wb({da:"CitationIdToPdfIds",ca:k,ea:l,V:ab,Y:db,transaction:g}));f.push(wb({da:"PrimaryPdfIdToRemoteUrls",ca:m,ea:q,V:$a,Y:t=>t,transaction:g}));f.push(wb({da:"Highlight",ca:n,ea:p,V:bb,Y:Ja,transaction:g}));f.push(lb(g));await Promise.all([...f,g.complete]);a.g=c;a.h=!1;a.j=d;return{I:r,R:b,v:a.g}},pb=async function(a,b){b=await b.objectStore("CitationIdToPdfIds").index("PdfIds",a);if(b.size!==0){if(b.size!==1)throw new S("Invalid pdf id to citation id mapping: "+
a+" : "+JSON.stringify(b.entries())+". Pdf ids overlap.");b=Number(b.keys().next().value);if(!B(b))throw new S("Invalid pdf id to citation id mapping: "+a+" : "+JSON.stringify(b));return b}},qb=async function(a,b){b=await b.objectStore("CitationIdToPdfIds").get(""+a);if(b===void 0)return[];const c=eb(b);if(c===null)throw new S("Invalid citation id to pdf ids mapping: "+a+" : "+JSON.stringify(b));return c},sb=async function(a,b){b=await b.objectStore("PrimaryPdfIdToRemoteUrls").get(a)||[];if(!Array.isArray(b)||
!b.every(F))throw new S("Invalid primary pdf id to remote urls mapping: "+a+" : "+JSON.stringify(b));return b},ub=async function(a,b,c){c=await c.objectStore("Highlight").get(`${a}:${b}`);if(c!==void 0){var d=Ka(c);if(d===null)throw new S("Invalid highlight update of highlight id: "+a+":"+b+" : "+JSON.stringify(c));return d}},yb=async function(a,b){const c=await pb(a,b);if(!c)return[];b=await qb(c,b);for(const d of b)if(d.includes(a))return d;return[]},zb=async function(a,b){a=await yb(a,b);return a.length>
0&&a[0]||void 0},Ab=async function(a,b){b=b.objectStore("Highlight");var c=IDBKeyRange.bound(a,a+"\uffff",!1,!0);b=await b.getAll(c);c=L(b,Ka);if(c===null)throw new S("Invalid highlight updates of pdf id: "+a+" : "+JSON.stringify(b));return c},Bb=async function(a,b){return(a=await zb(a,b))?Ab(a,b):[]},Cb=async function(a){a=await a.objectStore("PendingUpdates").get("PendingUpdates");if(a===void 0)return{ha:new Map,fa:new N};var b=a&&typeof a==="object";const c=b?Pa(a.highlights):null;if(b)if(b=a.pdfIds,
b===void 0)var d=new N;else if(b&&typeof b==="object"){b:{var e=b.primaryPdfIdToPendingPdfIdsEntries;if(Array.isArray(e)){var f=new Map;for(g of e){if(!Array.isArray(g)||g.length!==2||!G(g[0])||!H(g[1])){var g=null;break b}f.set(g[0],new Set(g[1]))}g=f}else g=null}b:if(b=b.pendingPdfIdToPrimaryPdfIdEntries,Array.isArray(b)){e=new Map;for(d of b){if(!Array.isArray(d)||d.length!==2||!G(d[0])||!G(d[1])){d=null;break b}e.set(d[0],d[1])}d=e}else d=null;d=g&&d?new N({Aa:g,ya:d}):null}else d=null;else d=
null;if(!c||!d)throw new S("Invalid pending updates: "+JSON.stringify(a));return{ha:c,fa:d}},Db=async function(a,b,c){c=c.objectStore("PendingUpdates");const d=[];for(var e of a.keys()){var f=d,g=f.push,h=a.get(e);var k=h.g;var l=k.g;const z=[];for(const O of l.keys()){var m=z,q=m.push;var n=l.get(O);var p=n.j,r=n.g;const P=[];for(const A of r.keys()){var t=P,u=t.push;var v=r.get(A);v={clientId:v.clientId,update:J(v.update)};u.call(t,[A,v])}n={pageIndex:p,updateEntries:P,boundsIdPairList:na(n.h)};
q.call(m,[O,n])}k={pagePendingUpdatesEntries:z,pendingIdToPageIndexEntries:Array.from(k.h)};g.call(f,[e,{pendingUpdates:k,remoteUrl:h.ia,title:h.S,nextClientId:h.h}])}a=b.C;e=[];for(const z of a.keys())e.push([z,[...a.get(z)]]);b={primaryPdfIdToPendingPdfIdsEntries:e,pendingPdfIdToPrimaryPdfIdEntries:Array.from(b.J.entries())};return Q(c,"PendingUpdates",{highlights:d,pdfIds:b})},Eb=async function(a,b,c,d,e,f){if(c.length===0)throw Error("No pdf ids to record updates for ",d);if(f.length!==0){var g=
a.i.transaction(R,"readwrite"),[h,{ha:k,fa:l}]=await Promise.all([T(g),Cb(g)]);if(b===h){b=await Promise.all(c.map(r=>zb(r,g)));var m=void 0,q=[];for(let r=0;r<b.length;r++){var n=b[r];n!==void 0?m===void 0&&(m=n):(n=l.J.get(c[r]),n!==void 0?m===void 0&&(m=n):q.push(c[r]))}m=m||q[0];k.has(m)||k.set(m,new M);var p=k.get(m);p.S=e;p.updateUrl(d);f.forEach(r=>{p.K(r)});for(const r of q)Oa(l,m,r);await Promise.all([Db(k,l,g),g.complete]);a.h=fb(k)}}},Fb=async function(a){var b=a.j===0?0:(Date.now()-a.j)/
864E5;if(b>30)return{highlights:[],v:0};if(!a.h||b>=1)return{highlights:[],v:a.g};a=a.i.transaction(R,"readonly");const [c,{ha:d,fa:e}]=await Promise.all([T(a),Cb(a)]),f=[];b=[];let g=3E3;for(const h of d.keys()){const k=d.get(h),l=Math.min(g,k.F().length);if(l===0)break;g-=l;const m=yb(h,a).then(q=>{var n=[];q.length>0&&q[0]===h&&n.push(...q);q=(q=e.C.get(h))?[...q]:[];n.push(...q);var p=k.F();if(p.length===0||l<=0)n=null;else{p.length>l&&(p.length=l);q=k.S;var r=k.ia;const t=[];for(const u of p){const v=
{id:u.l};if(u.m||u.text){v.text=u.text;v.color_id=u.m;p=u.o;const z=[];for(const {pageIndex:O,bounds:P}of p)for(const A of P)z.push({page_index:O,left:A.left,right:A.left+A.width,top:A.top,bottom:A.top+A.height,angle:A.angle});v.bounds=z;u.comment&&(v.comment=u.comment)}t.push(v)}n={pdf_ids:n,title:q,url:r,highlights:t}}n&&f.push(n)});b.push(m)}await Promise.all(b);return{highlights:f,v:c}},Gb=async function(a,b){a=a.i.transaction(R,"readonly");const [c,d,e]=await Promise.all([Bb(b,a),T(a),yb(b,a)]);
return{Fa:e,highlights:c,v:d}},ib=class{constructor(a){if(hb!==hb)throw Error("HighlightStorage should only be created by the static create() method.");this.i=a;this.j=this.g=0;this.h=!1}async delete(){await Xa(this.i);nb(this)}};function Hb(a){return a===1?1E3:a===2?5E3:1E4}
var U=async function(a,b=!1){a.ja||(a.la=mb(a.h,b),a.ja=!0);return a.la},Ib=async function(a,b,c){var d=await U(a);const {highlights:e,v:f,Fa:g}=await Gb(d,b);b=chrome.runtime;d=b.sendMessage;a=a.h;var h=e.map(La);c={type:"cachedHighlightsResponse",pdfIds:g,userId:a,highlightUpdates:h.map(J),syncedToServerTs:f,messageKey:c};d.call(b,c)},Jb=function(a){return U(a).then(b=>ob(b))},W=async function(a,b={}){const {H:c=!1,ab:d=!1}=b;if(!a.i&&a.g.length!==0){var {promise:e,resolve:f}=ia();a.i=e;b=()=>{f();
a.i=null};var g=0,h=[];try{var k=await U(a,d);({v:g,highlights:h}=await Fb(k))}catch(p){b();V(a,p);return}k=h.length>0;var l=Na(h,g);h=a.g[0];var m=Ma(a.h,h,a.U,a.ma),q=Date.now();k=Math.min(a.A,!k&&!c||a.T===6?a.na+3E4:q);if(k>q)b(),Kb(a,k);else{a.A=Number.MAX_SAFE_INTEGER;clearTimeout(a.j);a.j=0;a.na=q;k=await fetch(m,l).catch(()=>null);var n=await Lb(k);l=n.Z;m=n.ua;k=l.type;if(k===5&&a.B>0)a.B--,g=Hb(3-a.B),b(),Kb(a,Date.now()+g);else{q={};try{q=await Mb(a,n)}catch(p){b();V(a,p);return}n=q.v;
h=Da(h,a.h,m,q.R,n,l,q.I);chrome.runtime.sendMessage(h);b();k===0&&a.M&&(a.M=!1,a.oa.get("snoozeDbErrorAt",p=>{p=za(p);Aa(p,a.h);const r={},t=[];for(const u of p.g)t.push({u:u.userId,fc:u.Ia,qe:u.Za,fp:u.Ja,ge:u.Ka});r.snoozeDbErrorAt=t;a.oa.set(r)}));a.T=k;a.B=k===5?0:3;if(k===2)return a.g.shift(),W(a,{H:!0});if(k===0&&n>g)return W(a,{H:!0});a.g.length=0}}}},Nb=async function(a,b,c){a.i&&await a.i;a.g.includes(b)||a.g.push(b);a.U=c;return W(a,{H:!0,ab:!0})},Ob=async function(a,b,c,d,e,f){return Eb(await U(a),
b,c,d,e,f)},Pb=async function(a,b,c,d,e,f,g,h,k,l,m){if(f<0||g!==a.h||!h||c.length===0||!d)throw Error("Invalid update request");await Ob(a,b,c,d,e,l);a.g.includes(f)||a.g.push(f);a.U=h;a.ma=k;return W(a,{H:m})},V=function(a,b){a.ja=!1;let c=10;b instanceof Qa?c=7:b instanceof Ra?c=8:b instanceof S&&(c=9);a.T=c;a.M=!0;a=Da(0,a.h,"",!1,0,C(c),[]);chrome.runtime.sendMessage(a)},Kb=function(a,b){var c={};b>=a.A||(clearTimeout(a.j),a.A=b,a.j=setTimeout(()=>{a.j=0;W(a,c)},Math.max(0,b-Date.now())))},Lb=
async function(a){let b=0,c=0,d="";var e=null;if(!a||a.status>=500&&a.status<=599)b=5;else if(a.status!==200)b=6;else{var f=null;try{f=await a.json()}catch(h){}a=typeof f;if((a!="object"||f==null)&&a!="function")return{Z:C(6),ua:d,qa:e};typeof f.X==="string"&&f.X.length>0&&(d=f.X);if(f.L)b=2;else if(f.E==="UD")b=3;else if(f.E==="LF")b=4;else if(f.E==="HF")b=11;else if(typeof f.E==="string"&&f.E.startsWith("HV:"))f=Number(f.E.substring(3)),f>0?(b=12,c=f):b=6;else if(f.HSR){var g=f.HSR;g&&typeof g===
"object"?(e=Number(g.synced_from_timestamp_usec),f=Number(g.synced_to_timestamp_usec),I(e)&&I(f)?(a=L(g.client_pdf_id_updates,Fa),g=L(g.highlights_updates,Ia),e=a===null||g===null?null:{eb:e,fb:f,Ga:a,La:g}):e=null):e=null;e||(b=6)}else d||(b=6)}return{Z:C(b,c),ua:d,qa:e}},Mb=async function(a,b){const c=b.Z.type;b=b.qa;return xb(await U(a),b,c)},Qb=class{constructor(a){this.h=a;this.oa=new x;this.U="";this.g=[];this.ma="";this.i=null;this.la=mb(this.h);this.na=0;this.A=Number.MAX_SAFE_INTEGER;this.j=
0;this.B=3;this.T=null;this.M=this.ja=!0}},X=function(a){var b=Rb;b.g.has(a)||b.g.set(a,new Qb(a));return b.g.get(a)},Sb=function(a){const b=a.Xa,c=a.Na,d=X(a.userId);Ib(d,b,c).catch(e=>{V(d,e)})},Tb=function(a){const b=a.W,c=a.userId,d=a.ka,e=a.language,f=a.N,g=a.title,h=a.Ya,k=a.ba,l=a.v;a=a.H;const m=X(c);Pb(m,l,h,f,g,b,c,d,e,k,a).catch(q=>{V(m,q)})},Ub=function(a){const b=X(a.userId);Jb(b).catch(c=>{V(b,c)})},Vb=function(a){const b=a.W,c=a.ka,d=X(a.userId);Nb(d,b,c).catch(e=>{V(d,e)})},Wb=class{constructor(){this.g=
new Map}};const Xb=chrome.runtime.getURL("reader.html"),Yb=/^scholar[.]google[.][^.]+([.][^.]+)?$/,Zb="chrome-extension://"+chrome.runtime.id,$b=["chrome-extension://efaidnbmnnnibpcajpcglclefindmkaj/viewer.html","chrome-extension://oemmndcbldboiebfnladdacbdfmadadm/content/web/viewer.html","chrome-extension://ieepebpjnkhaiioojkepfniodjmjjihl/data/pdf.js/web/viewer.html"];function ac(a,b){if(!a)return"";for(const {name:c,value:d}of a)if(c&&c.toLowerCase()===b)return d||"";return""}
var bc=function(a){a.g.size+a.i.size<=0||a.B||(a.B=!0,setTimeout(()=>{a.B=!1;a.i=a.g;a.g=new Map;bc(a)},36E4))},Y=function(a,b){var c=cc;a=`${a} ${b}`;b=c.g.get(a);b||(b={},c.g.set(a,b),bc(c));return b},dc=function(a){a.h.size+a.j.size<=0||a.A||(a.A=!0,setTimeout(()=>{a.A=!1;const b=[];for(const c of a.j.values())b.push(c.ruleId);chrome.declarativeNetRequest.updateSessionRules({removeRuleIds:b});a.j=a.h;a.h=new Map;dc(a)},15E3))},ec=function(a,b){var c=cc;b=`${a} ${b}`;({Wa:b}=c.g.get(b)||c.i.get(b)||
{});if(!b)return Promise.resolve({N:"",Ca:"",Da:"",parentFrameId:NaN});const d=Number(b.split(" ")[1]),{ta:e}=c.g.get(b)||c.i.get(b)||{};a=`${a} ${0}`;a=c.g.get(a)||c.i.get(a)||{};const f=a.ta||"";let g;const h=((g=a.O)==null?void 0:g.hb)||"";c=c.h.get(b)||c.j.get(b);return(c?c.promise:Promise.resolve()).then(()=>({N:e||"",Ca:f,Da:h,parentFrameId:d}))};
class fc{constructor(){this.i=new Map;this.g=new Map;this.j=new Map;this.h=new Map;const a=chrome.extension.inIncognitoContext;this.M=a?1E8:1;this.A=this.B=!1;chrome.declarativeNetRequest.getSessionRules().then(b=>{const c=[];for(const d of b)(a&&d.id>=1E8||!a&&d.id<1E8)&&c.push(d.id);c.length<=0||chrome.declarativeNetRequest.updateSessionRules({removeRuleIds:c})})}}const cc=new fc;
chrome.webRequest.onBeforeSendHeaders.addListener(a=>{if(!(a.tabId<0||a.type==="xmlhttprequest")){var b=ac(a.requestHeaders,"referer"),c=a.url;Y(a.tabId,a.frameId).cb={url:c,referrer:b}}},{urls:["<all_urls>"]},["requestHeaders","extraHeaders"]);
chrome.webRequest.onHeadersReceived.addListener(a=>{if(a.tabId>=0&&a.type==="main_frame"){var b=a.url,c=a.statusCode,d=Y(a.tabId,a.frameId);if(d.O&&d.O.sa){if(c<300||c>=400)d.O.sa=!1}else c>=300&&c<400?d.O={sa:!0,hb:b}:d.O=void 0}if(!(a.tabId<0||a.type==="xmlhttprequest"||(a.initiator||"").startsWith("chrome-extension://")||ac(a.responseHeaders,"content-type").split(";",1)[0].trim().toLowerCase()!=="application/pdf")){c=a.tabId;d=a.url;b=cc;a=`${c} ${a.frameId}`;var {cb:e}=b.g.get(a)||b.i.get(a)||
{};let f=(e==null?void 0:e.referrer)||"";(e==null?void 0:e.url)!==d&&(f="");(e=b.h.get(a)||b.j.get(a))&&chrome.declarativeNetRequest.updateSessionRules({removeRuleIds:[e.ruleId]});e=b.M++;c=chrome.declarativeNetRequest.updateSessionRules({addRules:[{action:{requestHeaders:[{header:"referer",operation:"set",value:f}],type:"modifyHeaders"},condition:{initiatorDomains:[(new URL(d)).hostname],tabIds:[c],urlFilter:`|${d}|`},id:e}]})||Promise.resolve();b.h.set(a,{ruleId:e,promise:c});dc(b)}},{urls:["<all_urls>"]},
["responseHeaders"]);chrome.webNavigation.onCommitted.addListener(a=>{if(a.url!==Xb){var b=a.url;Y(a.tabId,a.frameId).ta=b}else{b=a.tabId;var c=a.parentFrameId;Y(b,a.frameId).Wa=`${b} ${c}`}});
function hc(a){chrome.windows.getCurrent(b=>{if(b.height&&b.width){var c=Math.min(b.height,560),d=Math.min(b.width,650);chrome.windows.create({focused:!0,left:Math.round(b.left+Math.max(0,(b.width-d)/2)),top:Math.round(b.top+Math.max(0,(b.height-c)/2)),height:c,width:d,url:"local_file_access.html#wid="+b.id,type:"normal"});b={};b.fac=`${a+1}:${Date.now()}`;(new x).set(b)}})}
chrome.extension.isAllowedFileSchemeAccess(function(a){a||chrome.webNavigation.onBeforeNavigate.addListener(function(){(new x).get(["fac"],b=>{b=((b||{}).fac||"").split(":");const c=Number(b[0])||0;b=(Number(b[1])||0)+12096E5*2**c;c>=4||Date.now()<b||chrome.extension.isAllowedFileSchemeAccess(function(d){d||hc(c)})})},{url:[{urlPrefix:"file://",pathSuffix:".pdf"},{urlPrefix:"file://",pathSuffix:".PDF"}]})});
function ic(a){const b={credentials:"include"};switch(a.method){case "GET":break;case "POST":if(typeof a.body!=="string")return null;b.method="POST";b.body=a.body;break;default:return null}typeof a.timeout==="number"&&(b.signal=AbortSignal.timeout(a.timeout));return b}function jc(a){return[".proquest.com",".wiley.com",".ieee.org",".ebscohost.com"].find(b=>a.endsWith(b))}
function kc(a,b){return new Promise(c=>{chrome.webNavigation.getAllFrames({tabId:b},d=>{d||c(!1);const e=new Map;var f=0;for(var g of d)d=g.frameId,e.set(d,g),g.url===a&&(f=d);f===0&&c(!0);g=f;var h=e.get(f);for(h||c(!1);g!==0;){g=h.parentFrameId;if(d=f=e.get(g))a:{let l=d=void 0;h=h.url;var k=f.url;try{l=new URL(h),d=new URL(k)}catch(m){d=!1;break a}h=jc(l.origin);d=jc(d.origin);d=!!h&&h===d}d||c(!1);h=f}c(!0)})})}
function lc(a,b,c,d){a=a!==b;let e;try{e=new URL(b)}catch(f){}b=e?e.hash:"BAD";b=b===""||b.match(/^#page=([0-9]+(.[0-9]+)?)$/);return a&&d&&b?chrome.scripting.executeScript({target:{tabId:c},files:["historyscript-compiled.js"]}).then(f=>!!f[0].result).catch(()=>!1):Promise.resolve(!1)}
function mc(a,b,c,d){return a!==b&&d?chrome.scripting.executeScript({target:{tabId:c},func:function(){return{width:window.innerWidth,height:window.innerHeight}}}).then(e=>e[0].result).catch(()=>Promise.resolve({width:0,height:0})):Promise.resolve({width:0,height:0})}function nc(a){return chrome.scripting.executeScript({target:{tabId:a},func:function(){return document.referrer}}).then(b=>Yb.test((new URL(b[0].result+"")).host)).catch(()=>!1)}
chrome.runtime.onConnect.addListener(a=>{const b=a.sender,c=b.tab.id;if(b.origin===Zb){var d=!0;a.onMessage.addListener(e=>{if(b.tab&&b.frameId!==void 0&&e&&typeof e==="object")switch(e.type){case "getUrl":ec(b.tab.id,b.frameId).then(h=>{const k=h.N,l=h.Ca,m=h.Da,q=h.parentFrameId;k||console.error("Failed to get URL to load",b);const n=nc(c);kc(k,c).then(p=>{const r=lc(k,l,c,p),t=mc(k,l,c,p);Promise.all([r,t,n]).then(([u,v,z])=>{d&&a.postMessage({pdfUrl:k,topWindowUrlBeforeRedirects:m||l,isScholarTopReferrer:z,
isHistoryOnTopWindow:u,shouldShowSignedInFeatures:p,topWindowWidth:v.width,topWindowHeight:v.height,parentFrameId:q})})})},h=>{console.error("Failed to get URL to load, reason:",h,b)});break;case "fetch":const f=e.url,g=e.id;typeof f==="string"&&typeof g==="number"&&(e=ic(e))&&fetch(f,e).then(h=>h.json()).then(h=>{d&&a.postMessage({type:"fetch",id:g,json:h})}).catch(h=>{d&&a.postMessage({type:"fetch",id:g,error:h.message})})}});a.onDisconnect.addListener(()=>{d=!1})}});let Z=null;
async function oc(){const a=chrome.runtime.getURL("offscreen.html");if((await chrome.runtime.getContexts({contextTypes:["OFFSCREEN_DOCUMENT"],documentUrls:[a]})).length>0)return Promise.resolve();Z?await Z:(Z=chrome.offscreen.createDocument({url:"offscreen.html",reasons:[chrome.offscreen.Reason.CLIPBOARD],justification:"Write text to the clipboard."}),await Z,Z=null)}async function pc(a,b,c){await oc();chrome.runtime.sendMessage({type:"offscreen-copy",timestamp:a,plainText:b,htmlText:c})}
const Rb=new Wb;
chrome.runtime.onMessage.addListener((a,b)=>{if(a&&b.origin===Zb&&typeof a==="object")if(b=a.type,b==="background-copy")typeof a.timestamp!=="number"||typeof a.plainText!=="string"||typeof a.htmlText!=="string"&&a.htmlText!==void 0||pc(a.timestamp,a.plainText,a.htmlText);else if(b==="cachedHighlightsRequest"){if(a&&typeof a==="object"&&a.type==="cachedHighlightsRequest"){b=a.userId;var c=a.pdfUrl,d=a.pdfId;a=Number(a.messageKey);a=K(b)&&F(c)&&G(d)&&typeof a==="number"&&Number.isFinite(a)&&a>0?{type:"cachedHighlightsRequest",
userId:b,N:c,Xa:d,Na:a}:null}else a=null;a&&Sb(a)}else if(b==="syncHighlightsRequest"){if(a&&typeof a==="object"&&a.type==="syncHighlightsRequest"){b=Number(a.authuser)||0;c=a.userId;d=a.xsrf;var e=a.language,f=a.pdfUrl,g=a.title,h=a.pdfIds;b:{var k=a.highlightUpdates;if(Array.isArray(k)){var l=[];for(m of k){k=y(m);if(!k){var m=null;break b}l.push(k)}m=l}else m=null}l=Number(a.syncedToServerTs)||0;a=a.forceSync;a=Ba(b)&&K(c)&&typeof d==="string"&&typeof e==="string"&&e.length>0&&F(f)&&typeof g===
"string"&&H(h)&&m&&I(l)&&typeof a==="boolean"?{type:"syncHighlightsRequest",W:b,userId:c,ka:d,language:e,N:f,title:g,Ya:h,ba:m,v:l,H:a}:null}else a=null;a&&Tb(a)}else b==="discardGlobalPendingHighlights"?(a&&typeof a==="object"&&a.type==="discardGlobalPendingHighlights"?(a=a.userId,a=K(a)?{type:"discardGlobalPendingHighlights",userId:a}:null):a=null,a&&Ub(a)):b==="refreshHighlightCache"&&(a&&typeof a==="object"&&a.type==="refreshHighlightCache"?(b=a.userId,c=Number(a.authuser)||0,a=a.xsrf,a=K(b)&&
Ba(c)&&typeof a==="string"?{type:"refreshHighlightCache",userId:b,W:c,ka:a}:null):a=null,a&&Vb(a))});async function qc(){for(const a of $b)try{return await fetch(a),!0}catch(b){}return!1}chrome.runtime.onInstalled.addListener(a=>{a.reason===chrome.runtime.OnInstalledReason.INSTALL&&qc().then(b=>{b&&chrome.tabs.create({url:"https://scholar.google.com/scholar/reader-install.pdf"})})});}).call(this);
