(function(){/*

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/
var e=this||self;var h;h=typeof Symbol==="function"&&typeof Symbol()==="symbol"?Symbol.for?Symbol.for("jas"):Symbol("jas"):void 0;const k=typeof Symbol==="function"&&typeof Symbol()==="symbol"?h:"h",l=Object.getOwnPropertyDescriptor(Array.prototype,"g");Object.defineProperties(Array.prototype,{g:{get(){const b=m(this);return l?l.get.call(this)+"|"+b:b},configurable:!0,enumerable:!1}});
function m(b){function a(g,f){g&c&&d.push(f)}const c=b[k]|0,d=[];a(1,"IS_REPEATED_FIELD");a(2,"IS_IMMUTABLE_ARRAY");a(4,"IS_API_FORMATTED");a(512,"STRING_FORMATTED");a(1024,"GBIGINT_FORMATTED");a(1024,"BINARY");a(8,"ONLY_MUTABLE_VALUES");a(16,"UNFROZEN_SHARED");a(32,"MUTABLE_REFERENCES_ARE_OWNED");a(64,"CONSTRUCTED");a(128,"HAS_MESSAGE_ID");a(256,"FROZEN_ARRAY");a(2048,"HAS_WRAPPER");a(4096,"MUTABLE_SUBSTRUCTURES");a(8192,"KNOWN_MAP_ARRAY");c&64&&(b=c>>14&1023||536870912,b!==536870912&&d.push(`pivot: ${b}`));
return d.join(",")};typeof Proxy!=="undefined"&&new Proxy({},{getPrototypeOf:n,setPrototypeOf:n,isExtensible:n,preventExtensions:n,getOwnPropertyDescriptor:n,defineProperty:n,has:n,get:n,set:n,deleteProperty:n,apply:n,construct:n});function n(){throw Error("this array or object is owned by JSPB and should not be reused, did you mean to copy it with copyJspbArray? See go/jspb-api-gotchas#construct_from_array");};function p(){};(function(){const b=e.jspbGetTypeName;e.jspbGetTypeName=b?a=>b(a)||void 0:p})();function q(){var b=window.location.hash;return new URLSearchParams(b[0]==="#"?b.substr(1):"")};function r(b){b=Number(b);return!b||b<0?"":b.toFixed(2)}function u(b){b=String(b);const a=b.split(",").map(Number);return a.length===1&&a[0]>0||a.length===3&&a[0]>0&&!isNaN(a[1])&&!isNaN(a[2])?b:""}function v(b){return b!=="0"&&b!=="1"?"":b}
function w(b,a){if(b){var c=(history.state||{}).fractionalStartPage,d=null,g=null,f=null,t=null;c?a&&(d=(history.state||{}).navpanes,f=(history.state||{}).zoom):(a=q(),c=r(a.get("page"))||"1",d=v(a.get("navpanes")),g=a.get("view"),f=u(a.get("zoom")),t=a.get("nameddest"));b.postMessage({type:"restoreReadingProgress",fractionalStartPage:c,navpanes:d,view:g,zoom:f,nameddest:t},"*")}}function x(){return(new URLSearchParams(window.location.hash.substring(1))).get("gsr")==="0"}
function y(){let b;window.addEventListener("popstate",()=>{x()||b&&w(b,!1)});window.addEventListener("message",a=>{if(a.origin==="chrome-extension://"+chrome.runtime.id&&a.data&&typeof a.data==="object"&&!x())if(b=a.source,a.data.type==="ready")w(b,!0);else if(a.data.type==="pushState"){var c=r(a.data.fractionalStartPage),d=u(a.data.zoom);const g=v(a.data.navpanes);if(c||d||g){a=Number(c);const f=q();f.set("page",a.toFixed(2));history.pushState({fractionalStartPage:c,navpanes:g,zoom:d},"","#"+f.toString())}else console.log("fractionalStartPage, zoomPct, or navpanes required")}else a.data.type===
"replaceState"&&(c=r(a.data.fractionalStartPage),d=u(a.data.zoom),a=v(a.data.navpanes),c||d||a?history.replaceState({fractionalStartPage:c,navpanes:a,zoom:d},""):console.log("fractionalStartPage, zoomPct, or navpanes required"))})};function z(){var b=history.state;if(b===null)return!0;if(typeof b!=="object")return!1;b=Object.keys(b);const a=["fractionalStartPage","navpanes","zoom"],c=b.filter(d=>a.includes(d));return b.length===c.length}window.gsrHistoryTopWindow===void 0&&(window.gsrHistoryTopWindow=z())&&y(); return window.gsrHistoryTopWindow;})();
